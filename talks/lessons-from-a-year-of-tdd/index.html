<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8"/>
  <title>Lessons From a Year of TDD</title>
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  
  <link href="https://channikhabra.com/sass/baseof.min.230a3bdad4709e0e0fe746499b45843515eb7b44922f9d101dd7fc03f2c27770.css" rel="stylesheet" />
  
  <meta property="og:title" content="Lessons From a Year of TDD" />
<meta property="og:description" content="This talk was delivered in Technical Agility Day, Chandigarh (June 15, 2019).
 Transcript Following is the transcript for the talk. There was no video recording, but the transcript I prepared for the talk should sufficiently convey what I meant to say in the talk.
Introduction   Experience from a year of TDD by Charanjit Singh   Hello everyone, my name is Charanjit. I am working as a technical lead at Trantor." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://channikhabra.com/talks/lessons-from-a-year-of-tdd/" />

<meta property="og:image" content="https://channikhabra.com/talks/lessons-from-a-year-of-tdd/slides/01--introduction-to-tdd-talk.png" />
<meta property="article:published_time" content="2019-06-21T11:52:12+05:30" />
<meta property="article:modified_time" content="2019-06-21T11:52:12+05:30" />

  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://channikhabra.com/talks/lessons-from-a-year-of-tdd/slides/01--introduction-to-tdd-talk.png"/>

<meta name="twitter:title" content="Lessons From a Year of TDD"/>
<meta name="twitter:description" content="This talk was delivered in Technical Agility Day, Chandigarh (June 15, 2019).
 Transcript Following is the transcript for the talk. There was no video recording, but the transcript I prepared for the talk should sufficiently convey what I meant to say in the talk.
Introduction   Experience from a year of TDD by Charanjit Singh   Hello everyone, my name is Charanjit. I am working as a technical lead at Trantor."/>

</head>
<body>
      <section class="container">
        <header class='root-header'><nav class='top-nav'>
  <div class='brand'>
    <a href='/'>
      <img class='brand-avatar' src='/img/avatar.png' alt='Personal space of Charanjit Singh' />
    </a>
  </div>

  <ul class='nav-items'>
    
    <li class='nav-item'><a href='/blog' title='All blog posts'>Blog</a></li>
    
    <li class='nav-item'><a href='/categories/poem' title='Poems'>Poems</a></li>
    
    <li class='nav-item'><a href='/talks' title='Talks'>Talks</a></li>
    
    <li class='nav-item'><a href='/about' title='About me'>About</a></li>
    
  </ul>
</nav>
</header>

        <main class='root'>

<link href="https://channikhabra.com/sass/single.min.a7c42797b9daf03305b1b6618da780bc6cf37dc077a6ccadb746daaa3cef1cee.css" rel="stylesheet" />
<section class='content'><header class='content-header'>
  <h1>Lessons From a Year of TDD</h1>

  <span class="content-meta">
    <span
      class="meta-item date">Jun 21, 2019</span>
    
  </span>
</header>
<article class='main-article'>
    

<iframe
  src="//slides.com/channikhabra/lessons-from-a-year-of-tdd/embed?style=light"
  width="100%"
  height="420"
  scrolling="no"
  frameborder="0"
  webkitallowfullscreen
  mozallowfullscreen
  allowfullscreen
></iframe>


<blockquote>
<p>This talk was delivered in <a href="https://agilenetworkindia.com/events/technical-agility-day-chandigarh/" title="Technical Agility Day">Technical Agility Day, Chandigarh (June 15, 2019)</a>.</p>
</blockquote>

<h2 id="transcript">Transcript</h2>

<p>Following is the transcript for the talk. There was no video recording, but the
transcript I prepared for the talk should sufficiently convey what I meant to
say in the talk.</p>

<h3 id="introduction">Introduction</h3>

<figure>
    <img src="slides/01--introduction-to-tdd-talk.png"
         alt="Experience from a year of TDD by Charanjit Singh" width="100%"/> <figcaption>
            <h4>Experience from a year of TDD by Charanjit Singh</h4>
        </figcaption>
</figure>


<p>Hello everyone, my name is Charanjit. I am working as a technical lead at
Trantor.</p>

<p>I joined Trantor a year ago, in one of Trantor&rsquo;s projects where I was fortunate
enough to see people willing to apply test driven development on what was going
to become a rather complex project. I am leading one part of this project under
a team named &ldquo;The cloud team&rdquo;. This talk is the story of things we learned while
practicing test driven development to build a micro-services based cloud with
several third-party integrations.</p>

<p>Our cloud is built primarily with Node.js (express.js), uses GraphQL to
communicate with clients as well as for inter-service communication, backed by
Azure&rsquo;s CosmosDB (with its Mongo API), has Kafka for messaging queue, and
Elasticsearch for complex search solutions. We have about 9 services till today,
and 3 third party integrations. We are building an IOT-ish solution, and our
cloud primarily serves the android application running on our custom hardware,
along with some companion applications (for support and sales).</p>

<p>Before we get into the details of how we did TDD in our project, or of TDD
itself, let&rsquo;s take a step back and work out some abstract thoughts. Abstract
thoughts about what we are trying to accomplish with techniques like TDD.
Actually, let&rsquo;s take all the steps back and go to the very beginning.</p>

<p>In the beginning, there were myths. Humans weren&rsquo;t always recording history. The
myths were used to fill the plot holes in stories told by one generation to
next. A common and very fascinating theme among the myths of different cultures
is that of magic.</p>

<figure>
    <img src="slides/02--the-wizard.png"
         alt="The Wizard" width="100%"/> <figcaption>
            <h4>The Wizard</h4>
        </figcaption>
</figure>


<p>Allegedly there used to be some very special people who could use the mysterious
powers. With flick of a wand they could create things out of thin air, they
could put life into the inanimate, they could bend the reality itself to their
will.</p>

<p>But those were of course myths. What we have now are developers.</p>

<figure>
    <img src="slides/03--the-stallman.png"
         alt="The Stallman" width="100%"/> <figcaption>
            <h4>The Stallman</h4>
        </figcaption>
</figure>


<p>Well, I argue that developers are in fact the wizards of the information age. We
certainly meet the criteria:</p>

<ul class="task-list">
<li><label><input type="checkbox" checked disabled class="task-list-item"> Create things (business/products/tools) out of thin air (without any raw materials)</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Put life into the inanimate (software is practically the soul of computer)</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Bend reality to our will (/r/insidethesoftstone reality is what you want it to be)</label></li>
</ul>

<p></p>

<figure>
    <img src="slides/04--the-stallzard.png"
         alt="The Stallzard" width="100%"/> <figcaption>
            <h4>The Stallzard</h4>
        </figcaption>
</figure>


<p>Raw materials for the products a software developer creates are the thoughts.
The third point here is the focus of this talk.</p>

<h3 id="software-as-universe">Software as Universe</h3>

<figure>
    <img src="slides/05--the-universe.png"
         alt="The Universe" width="100%"/> <figcaption>
            <h4>The Universe</h4>
        </figcaption>
</figure>


<p>I am not kidding. I believe it is fair to say that every software is a universe
of its own. It has its own rules it operates within, its own reality, which is
at your disposal to do whatever with.</p>

<p>It is a living and breathing thing which must change and evolve and die as well.</p>

<p>Do anyone here watches Rick and Morty? It is a good show about a rockstar and a
junior software developer. Try it sometime.</p>

<figure>
    <img src="slides/06--the-microverse.png"
         alt="The Microverse" width="100%"/> <figcaption>
            <h4>The Microverse</h4>
        </figcaption>
</figure>


<p>One of the episodes are about the microverse battery. The rockstar developer
creates a miniature universe whose sole purpose is to provide power to his car.
It is essentially a very complex car battery.</p>

<p>Funnier thing in that episode, the universe within the universe in the battery
does the exact same thing. Creates a universe whose sole purpose is to power its
host.</p>

<figure>
    <img src="slides/07--many-layers-of-microverse.png"
         alt="Many layers of the Microverse" width="100%"/> <figcaption>
            <h4>Many layers of the Microverse</h4>
        </figcaption>
</figure>


<p>Software we write are not very different. We create entire universe to serve our
needs, and it is rarely created in isolation. Usually our universe has a bunch
of other, more complex universes wrapped around it.</p>

<figure>
    <img src="slides/08--realm-of-tux.png"
         alt="The realm of Tux" width="100%"/> <figcaption>
            <h4>The realm of Tux</h4>
        </figcaption>
</figure>


<p>We often start with a base universe of Operating system. The platform,
programming language, the frameworks, they all make up for our initial &ldquo;empty&rdquo;
worlds. They set up their layers of rules, on which then we write our own.
Layers and layers of worlds.</p>

<figure>
    <img src="slides/11--layers-of-software-universe.png"
         alt="Many layered of software universe" width="100%"/> <figcaption>
            <h4>Many layered of software universe</h4>
        </figcaption>
</figure>


<p>Now, how do we populate this empty universe with the inhabitants which would do
our bidding? Well, with our thoughts and prayers of course.</p>

<figure>
    <img src="slides/13--pray-to-the-machine.png"
         alt="Pray to the machine" width="100%"/> <figcaption>
            <h4>Pray to the machine</h4>
        </figcaption>
</figure>


<p>I am not kidding. But you get it, you aren&rsquo;t laughing. We literally send our
thoughts, often prayers as well, formulated in some special form governed by
some programming language to a compiler (or interpreter), which then inhabit and
basically forms the universe of our software.</p>

<blockquote>
<p>Asgard isn&rsquo;t a place. Asgard is its people.</p>
</blockquote>

<figure>
    <img src="slides/14--pray-to-the-compiler.png"
         alt="Pray to the compiler" width="100%"/> <figcaption>
            <h4>Pray to the compiler</h4>
        </figcaption>
</figure>


<p>That brings us to the corollary which takes us in the general direction of
practices like Test Driven Development.</p>

<figure>
    <img src="slides/15--bugs-are-thoughts-gone-wrong.png"
         alt="Bugs are thoughts too" width="100%"/> <figcaption>
            <h4>Bugs are thoughts too</h4>
        </figcaption>
</figure>


<h3 id="bugs-are-thoughts-gone-wrong">Bugs are thoughts, gone wrong</h3>

<blockquote>
<p>Correctness of software is inversely proportional to the client side product
team.</p>
</blockquote>

<p>Thoughts go wrong primarily in two ways:</p>

<ol>
<li>They are wrong to begin with. Mostly caused by misunderstanding</li>
<li>Thoughts that go wrong during translation</li>
</ol>

<p>We can create correct software if we can validate the correctness of thoughts
that get into the system, and those that reside it subsequently.</p>

<p>This is what TDD essentially do.</p>

<figure>
    <img src="slides/16--tdd-validates-thoughts.png"
         alt="Bugs are thoughts too" width="100%"/> <figcaption>
            <h4>Bugs are thoughts too</h4>
        </figcaption>
</figure>


<p>The first point points to the red-green-refactor cycle. When doing TDD, you
write down the &ldquo;what&rdquo; aspect of the unit/module/function you are going to write.
It essentially allow you to pause, sit back, and think about what you are going
to implement. How it should behave.</p>

<p>The second point points to the help we get from our well-written tests when we
have to then make changes in our.</p>

<h3 id="busting-some-myths">Busting some Myths</h3>

<h4 id="myth-1-tdd-is-time-consuming">Myth #1 : TDD is time consuming</h4>

<p>This one is half a myth. TDD does consume time when you are starting. Your
mileage may vary depending on how much experience your team has with TDD,
initial time consumption is more if there is a learning curve involved.
Disregarding the learning curve, developing same features took us roughly 30%
longer to develop new features in our project.</p>

<figure>
    <img src="slides/17--myth-tdd-is-time-consuming.png"
         alt="Myth #1: TDD is time consuming" width="100%"/> <figcaption>
            <h4>Myth #1: TDD is time consuming</h4>
        </figcaption>
</figure>


<p>But this time is an investment you are making into your software, as well as
your developers. When the project started off, we did start off slow. Other
teams (there are 3 including us) were delivering more &ldquo;story points&rdquo;. After
about 3-4 months however, both other teams had dedicated processes set up to
tackle bugs, to prioritize and decide which bugs to quash and which ones to live
with. We still don&rsquo;t have any process explicitly for bugs.</p>

<p>Our product is a startup, we have been going through a lot of changes and pivots
throughout the year. While other teams were struggling with new bugs after every
such change, we were delivering at pretty much the same pace. Every bug that
occurred in cloud got test(s) for it too, so no mistakes were repeated. Till
now, we have been able to keep the list of bugs small enough that we don&rsquo;t pay
particular attention to it.</p>

<p>On-boarding new people to our team was a no-op, we would just give them an
overview, and tell them to run the tests. We did put considerable amount of
effort to make the tests our live documentation for developers, and it paid
dividends.</p>

<figure>
    <img src="slides/24--tdd-gave-us-free-time.png"
         alt="TDD gave us time to invest elsewhere" width="100%"/> <figcaption>
            <h4>TDD gave us time to invest elsewhere</h4>
        </figcaption>
</figure>


<p>Not just that, TDD actually gave our team to do more than just our assigned
duties. Most notably, we were able to not have a separate dev/ops team at all,
and took care of provisioning a cloud with
<a href="https://en.wikipedia.org/wiki/Infrastructure_as_Code">IAC</a> (using Terraform and
Ansible), and a small sized K8s cluster too. Our development environment is
pristine as well. It just takes a single command (docker-compose up) to get the
complete cloud (including log aggregation, Elasticsearch, Kibana and Kafka)
running on new machine.</p>

<h4 id="myth-2-tdd-is-about-tests">Myth #2 : TDD is about tests</h4>

<p>It is not. &ldquo;DD&rdquo; in &ldquo;TDD&rdquo; is more important than &ldquo;T&rdquo;. We learned this the hard
way because of lack of experience with TDD. When you are applying TDD on a new
project, <strong>your tests should be driving the development</strong>. Tests by themselves
aren&rsquo;t the goal. The essential thing you must do to ensure this, is to ensure
that you write tests first.</p>

<figure>
    <img src="slides/24--myth-tdd-is-about-tests.png"
         alt="Myth #2: TDD is about Tests" width="100%"/> <figcaption>
            <h4>Myth #2: TDD is about Tests</h4>
        </figcaption>
</figure>


<p>Tests written after the fact are practically handicapped. No matter how good a
developer you are, when you are writing tests after you have written the
feature/code, the &ldquo;how&rdquo; aspect of your code will creep in, and your tests will
never be as effective as they could have been. Same goes for the feature you are
writing.</p>

<h4 id="myth-3-tdd-means-no-bugs">Myth #3 : TDD means no bugs</h4>

<p>This is what I&rsquo;ve been advertising so far, ain&rsquo;t I! Well, it is not a 100%
truth. Even if we ignore the fact that your tests will almost never be 100%
complete, TDD will not guarantee a fully correct software.</p>

<figure>
    <img src="slides/29--myth-tdd-means-no-bugs.png"
         alt="Myth #3: TDD means no bugs" width="100%"/> <figcaption>
            <h4>Myth #3: TDD means no bugs</h4>
        </figcaption>
</figure>


<p>TDD is your last line of defense. By the time you have sat down to judiciously
implement TDD, the thoughts that are going to populate your software&rsquo;s universe
have already been set. All you are going to do is verify that they behave as it
has been decided.</p>

<figure>
    <img src="slides/32--protect-yourself-from-your-po.png"
         alt="Adopt BDD" width="100%"/> <figcaption>
            <h4>Adopt BDD</h4>
        </figcaption>
</figure>


<p>BDD operates at a much higher layer than TDD. At the layer where discussions are
done and decisions are made. I believe a combination of BDD and TDD can create a
very solid software. We adopted BDD in our project at a much later time, looking
back at the long meetings we used to have, I can see how much time and confusion
it could have saved us.</p>

<h3 id="grow-as-a-developer">Grow as a developer</h3>

<figure>
    <img src="slides/33--tdd-guides-you-in-right-direction.png"
         alt="TDD Guides you in right direction" width="100%"/> <figcaption>
            <h4>TDD Guides you in right direction</h4>
        </figcaption>
</figure>


<p>It was an interesting observation. Team seem to have a much higher appreciation
for design patterns like dependency injection. We also observed a shift in PR
review comments toward a focus on software design and architecture. Discussions
we used to have to make our TDD approach more fruitful brought a cultural shift
in the team.</p>

<h3 id="when-adding-tdd-to-a-new-team">When adding TDD to a new team</h3>

<figure>
    <img src="slides/38--brace-yourself.png"
         alt="When adding TDD to a new team" width="100%"/> <figcaption>
            <h4>When adding TDD to a new team</h4>
        </figcaption>
</figure>


<p>Biggest resistance we faced was convincing developers that it&rsquo;s worth their
while to write tests <strong>before</strong> they write code for their code. We ended up
introducing an extra step in our PR review checklist: <em>ensure there is a &ldquo;test:&rdquo;
commit which only has test descriptions</em>. This helped somewhat, but it took some
time (and a lot of pair programming) till developers realized the benefits of
this process.</p>

<h3 id="things-i-wish-we-did">Things I wish we did</h3>

<h4 id="mutation-testing">Mutation Testing</h4>

<figure>
    <img src="slides/41--mutation-testing.png"
         alt="I wish we did: Mutation Testing" width="100%"/> <figcaption>
            <h4>I wish we did: Mutation Testing</h4>
        </figcaption>
</figure>


<p>So, coverage reports are big fat liars. They don&rsquo;t tell you how your tests are
doing. In my opinion, they are more like the Velocity Charts our Scrum Master
loves so much. They tell you if you are going in the correct general direction,
and it is very easy to make them lie.</p>

<p><a href="https://stryker-mutator.io/">Mutation test</a> is a rather interesting concept
that we played around with. Big idea is that the test-runner can modify your
code (e.g replace an if condition with <code>true</code> and <code>false</code>), and re-run your code
to verify how many mutations it can withhold. It gives a lot better insight into
the strength of your tests.</p>

<p>We experimented with mutation testing for a while. But I suppose because of lack
of integration of a platform for our CI (Bamboo) to present thorough coverage
reports, we haven&rsquo;t yet made mutation testing a part of our test process.</p>

<p>I can see how it can make PR reviews a lot more effective though. I hope we can
take some time out of our everlasting &ldquo;churn mode&rdquo; for this.</p>

<h4 id="bdd">BDD</h4>

<figure>
    <img src="slides/42--bdd.png"
         alt="I wish we did: Behavior Driven Development" width="100%"/> <figcaption>
            <h4>I wish we did: Behavior Driven Development</h4>
        </figcaption>
</figure>


<p>We implemented BDD a bit late (just a couple months ago) when we had some
critical modules for which we wanted automated tests, which required the
complete cloud up and running. Like all software projects, we have always been
on a rather tight schedule :-)</p>

<p>BDD could have saved us a lot of trouble and confusion. It contributes immensely
to help you maintain a ubiquitous language of the project, and make the
communication between product people and developers much more correct.</p>

<hr />

<p>I apologize for rushing the transcript a bit in last few headlines above. Need
to get this off my todo list :-). If I get to deliver this talk again at some
occasion, I will revisit and will probably add some velocity/burndown charts
from Jira as well.</p>

<figure>
    <img src="slides/47--thank-you.png"
         alt="Thank you for your patience" width="100%"/> <figcaption>
            <h4>Thank you for your patience</h4>
        </figcaption>
</figure>


  </article><footer class='content-footer'>
  <nav>
    
    <span class='footer-nav'>
      <label>Previous</label>
      <a href="https://channikhabra.com/talks/react-redux-workshop/">React/Redux Workshop</a>
    </span>
    

    
    <span class='footer-nav'>
      <label>Next</label>
      <a href="https://channikhabra.com/talks/secure-software-teams-trantor/">Secure Software Teams Trantor</a>
    </span>
    
  </nav>

  <div class='post-comments'>
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "channikhabrasblog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</footer>
</section>

        </main>

        <footer class='root-footer'>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-40340809-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</footer>
      </section>
    </body>
</html>
